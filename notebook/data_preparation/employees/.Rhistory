rename(cuil =CUIT, cargo = `FUNCIÓN Y NIVEL`, estructura = Secretaría, fecha = FECHA) |>
mutate(dni=str_remove_all(cuil,"^..|.$")) |>
mutate(dni = str_remove_all(dni,"^0")) |>
mutate(categoria_cargo = str_extract(cargo,"(II|I)$")) |>
mutate(cargo = str_remove_all(cargo,"(II|I)$")) |>
mutate(nombre=str_remove_all(nombre_completo,".+,")) |>
mutate(apellido = str_remove_all(nombre_completo,",.+")) |>
mutate(ultimo_registro_cargo =case_when(
str_detect(movimiento,"Renueva")~as.Date("2022-12-31"),
str_detect(movimiento,"FINALIZADA")~ as.Date("2022-01-31"),
TRUE ~ NA
)) |>
mutate(primer_registro_cargo = as.Date("2022-01-31")) |>
select(-cuil,-movimiento, -fecha) |>
mutate(organismo = "MINISTERIO DE RELACIONES EXTERIORES", tipo_contratacion = "LOCACION",fuente = "PDI", poder="EJECUTIVO",
ingreso_cargo = NA, baja_cargo = NA) |>
select(dni, nombre_completo, apellido, nombre, cargo, tipo_contratacion,organismo, estructura, ingreso_cargo, baja_cargo, primer_registro_cargo, ultimo_registro_cargo, poder, fuente) |>
mutate_if(is.character, str_to_upper) |>
mutate_if(is.character,remove_accents)->auxiliar_renovacion_exteriores_2022_complemento
auxiliar_renovacion_exteriores_2022_complemento |>
bind_rows(auxiliar_renovacion_exteriores_2022) |>
distinct(dni, .keep_all = TRUE) |>
bind_rows(auxiliar_altas_exteriores_2022) |>
distinct(dni, .keep_all = TRUE)->auxiliar_exteriores_2022
#Complemento
external_empleados_locacion_min_exteriores_renovaciones_complemento |>
rename(estado = ESTADO, apellido = APELLIDO, nombre = NOMBRE, cargo = CATEGORIA, ingreso_cargo = FECHA_CONTRATACION,
baja_cargo = FECHA_BAJA, cuil = CUIL) |>
select(cuil, apellido, nombre, cargo, ingreso_cargo, baja_cargo) |>
filter(baja_cargo>ingreso_cargo) |>
mutate(primer_registro_cargo = ingreso_cargo,
ultimo_registro_cargo =baja_cargo) |>
mutate(dni = str_remove_all(cuil,"^..|.$")) |>
mutate(dni = str_remove_all(dni,"^0")) |>
mutate(categoria_cargo = str_extract(cargo,"(II|I)$")) |>
mutate(cargo = str_remove_all(cargo,"(II|I)$")) |>
select(-cuil) |>
mutate(nombre_completo = paste(nombre, apellido)) |>
mutate(organismo = "MINISTERIO DE RELACIONES EXTERIORES", tipo_contratacion = "LOCACION",fuente = "PDI", poder="EJECUTIVO", estructura = NA) |>
select(dni, nombre_completo, apellido, nombre, cargo, tipo_contratacion,organismo, estructura, ingreso_cargo, baja_cargo, primer_registro_cargo, ultimo_registro_cargo, poder, fuente) |>
mutate_if(is.character, str_to_upper) |>
mutate_if(is.character,remove_accents)->auxiliar_exteriores_complemento
auxiliar_exteriores_complemento |>
bind_rows(auxiliar_exteriores_2025,auxiliar_exteriores_2024, auxiliar_exteriores_2023, auxiliar_exteriores_2022)->provisional_cancilleria
provisional_cancilleria|>
arrange(primer_registro_cargo) |>
distinct(dni, .keep_all = TRUE) |>
select(dni, primer_registro_cargo)->primeros_registros_cancilleria
provisional_cancilleria |>
distinct(dni, .keep_all = TRUE) |>
select(-primer_registro_cargo) |>
left_join(primeros_registros_cancilleria) ->interim_empleados_locacion_min_exteriores_2022_2024
#Certificaciones de servicios
external_certificaciones_servicios_min_exteriores_sept_dic_2024 |>
select(-`Fecha Último Convenio`) |>
rename(periodo= PERIODO, dni = DNI, nombre_completo = `APELLIDO Y NOMBRE`, estructura = AREA, categoria_cargo=CONVENIO,
cargo = CATEGORIA) |>
mutate(nombre = str_remove_all(nombre_completo,".+,"),
apellido = str_remove_all(nombre_completo,",.+"),
nombre_completo=paste(nombre, apellido)
) |>
mutate(tipo_contratacion = "LOCACION", organismo = "MINISTERIO DE RELACIONES EXTERIORES",
ingreso_cargo = NA, baja_cargo = NA, fuente = "PDI", poder = "EJECUTIVO") |>
mutate(primer_registro_cargo = paste0(str_remove_all(periodo,"..$"),"-",str_remove_all(periodo,"^...."),"-30"  )) |>
mutate(primer_registro_cargo=as.Date(primer_registro_cargo)) |>
group_by(dni) |>
arrange(primer_registro_cargo, .by_group = TRUE) |>
select(-periodo) |>
ungroup()->auxiliar_certificaciones_servicios_min_exteriores_sept_dic_2024
auxiliar_certificaciones_servicios_min_exteriores_sept_dic_2024 |>
group_by(dni) |>
slice_tail(n=1) |>
rename(ultimo_registro_cargo = primer_registro_cargo) |>
select(dni, ultimo_registro_cargo)->ultimos_registros_certificaciones_servicios_min_exteriores_sept_dic_2024
auxiliar_certificaciones_servicios_min_exteriores_sept_dic_2024 |>
group_by(dni) |> slice_head(n=1) |>
ungroup() |>
inner_join(ultimos_registros_certificaciones_servicios_min_exteriores_sept_dic_2024, by ="dni") |>
mutate(dni = as.character(dni))->interim_certificaciones_servicios_min_exteriores_sept_dic_2024
nombres_columnas_salud<-c("nombre_completo","cuil","cargo","expediente","urs","pago","estructura","primer_registro_cargo","ultimo_registro_cargo","tdr","autoridad")
colnames(external_empleados_locacion_min_salud_2019_2024)<-nombres_columnas_salud
external_empleados_locacion_min_salud_2019_2024 |>
select(-expediente, -urs,  -pago, -autoridad, -tdr) |>
mutate(dni = str_remove_all(cuil,"^..|.$")) |>
relocate(dni, cuil) |>
select(-cuil) |>
mutate(organismo = "MINISTERIO DE SALUD", tipo_contratacion = "LOCACION",fuente = "PDI", poder="EJECUTIVO", apellido = NA, nombre = NA,
ingreso_cargo = NA, baja_cargo = NA) |>
select(dni, nombre_completo, apellido, nombre, cargo, tipo_contratacion,organismo, estructura, ingreso_cargo, baja_cargo, primer_registro_cargo, ultimo_registro_cargo, poder, fuente) |>
mutate_if(is.character, str_to_upper) |>
mutate_if(is.character,remove_accents)->interim_empleados_locacion_min_salud_2019_2024
#Defensa
nombres_columnas_defensa<-c("nombre_completo","ingreso_cargo","baja_cargo","cuil","cargo","categoria_cargo","estructura","firmante","forma_pago","motivo_contratacion","contrato","monto","contrato_2","monto_2","contrato_3","monto_3","contrato_4","monto_4","contrato_5","monto_5")
colnames(external_empleados_locacion_min_defensa_2019_Dic_2024)<-nombres_columnas_defensa
external_empleados_locacion_min_defensa_2019_Dic_2024 |>
slice(-1) |>
slice_head(n=69) |>
filter(!is.na(cuil)) |>
select(1:7)->auxiliar_defensa_2024
external_empleados_locacion_min_defensa_2019_Dic_2024 |>
slice(74:149) |>
filter(!is.na(cuil)) |>
select(1:7)->auxiliar_defensa_2023
external_empleados_locacion_min_defensa_2019_Dic_2024 |>
slice(153:232)|>
filter(!is.na(cuil)) |>
select(1:7)->auxiliar_defensa_2022
external_empleados_locacion_min_defensa_2019_Dic_2024 |>
slice(236:307)|>
filter(!is.na(cuil)) |>
select(1:7)->auxiliar_defensa_2021
external_empleados_locacion_min_defensa_2019_Dic_2024 |>
slice(311:367)|>
filter(!is.na(cuil)) |>
select(1:7)->auxiliar_defensa_2020
external_empleados_locacion_min_defensa_2019_Dic_2024 |>
slice(371:442)|>
filter(!is.na(cuil)) |>
select(1:7)->auxiliar_defensa_2019
bind_rows(auxiliar_defensa_2024, auxiliar_defensa_2023, auxiliar_defensa_2022,
auxiliar_defensa_2021, auxiliar_defensa_2020, auxiliar_defensa_2019) |>
mutate(ingreso_cargo = convert_excel_date(ingreso_cargo)) |>
mutate(baja_cargo = convert_excel_date(baja_cargo))->auxiliar_defensa_2019_2024
auxiliar_defensa_2019_2024 |>
arrange(ingreso_cargo) |>
distinct(cuil, .keep_all = TRUE) |>
select(cuil, ingreso_cargo)->auxiliar_ingresos_defensa
auxiliar_defensa_2019_2024 |>
arrange(desc(baja_cargo)) |>
#We keep the last registry of each employee
distinct(cuil, .keep_all = TRUE) |>
mutate(baja_cargo = case_when(
is.na(baja_cargo)~ as.Date("2019-12-31"),
TRUE~baja_cargo
)) |>
select(-ingreso_cargo) |>
#We look for the first date they appeared
left_join(auxiliar_ingresos_defensa) |>
mutate(primer_registro_cargo = ingreso_cargo,
ultimo_registro_cargo = baja_cargo) |>
mutate(dni = str_remove_all(cuil,"\\d\\d-|-\\d")) |>
mutate(dni = str_remove_all(dni,"^0")) |>
mutate(organismo = "MINISTERIO DE DEFENSA", tipo_contratacion = "LOCACION",fuente = "PDI", poder="EJECUTIVO") |>
select(dni, nombre_completo, cargo, categoria_cargo,tipo_contratacion,organismo, estructura, ingreso_cargo, baja_cargo, primer_registro_cargo, ultimo_registro_cargo, poder, fuente) |>
mutate_if(is.character, str_to_upper) |>
mutate_if(is.character,remove_accents)->interim_empleados_locacion_defensa_2019_2023
#Certificaciones
nombres_columnas_certificaciones_defensa<-c("nombre_completo","cuit","escalafon","categoria_cargo","descartar","estructura","baja","descartar1","registro_cargo","descartar2","descartar3")
bind_rows(external_certificaciones_servicios_min_defensa_sept_2024 |> mutate(registro_cargo = "2024-09-30"),
external_certificaciones_servicios_min_defensa_oct_2024|> mutate(registro_cargo = "2024-10-31"),
external_certificaciones_servicios_min_defensa_nov_2024|> mutate(registro_cargo = "2024-11-30"),
external_certificaciones_servicios_min_defensa_dic_2024|> mutate(registro_cargo = "2024-12-31")) ->auxiliar_certificaciones
colnames(auxiliar_certificaciones)<-nombres_columnas_certificaciones_defensa
auxiliar_certificaciones |>
relocate(registro_cargo) |>
select(1:8) |>
select(-descartar) |>
mutate_if(is.character,str_to_upper) |>
mutate_if(is.character,remove_accents) |>
mutate(nombre = str_remove_all(nombre_completo,".+,"),
apellido = str_remove_all(nombre_completo,",.+")) |>
mutate(nombre_completo = paste(nombre, apellido)) |>
mutate(dni = str_remove_all(cuit,"^..-|-.$")) |>
select(-cuit) |>
mutate(tipo_contratacion = case_when(
str_detect(escalafon,"^CONTRATO")~ "LOCACION",
TRUE~ "PLANTA PERMANENTE"
) ) |>
rename(cargo =escalafon) |>
mutate(organismo = "MINISTERIO DE DEFENSA",fuente = "PDI", poder="EJECUTIVO") |>
mutate(cargo = case_when(
str_detect(cargo,"^CONTRATO")~"CONTRATADO",
TRUE~ cargo
)) |>
mutate(baja = str_remove_all(baja,"[A-Z]|,")) |>
mutate(baja = as.character(dmy(baja)) ) |>
mutate(cargo = case_when(
str_detect(categoria_cargo,"ASESOR|ASISTENTE|CONSULTOR")~categoria_cargo,
TRUE~ cargo
)) |>
mutate(categoria_cargo = case_when(
str_detect(categoria_cargo,"ASESOR|ASISTENTE|CONSULTOR")~ NA,
TRUE ~categoria_cargo
))->auxiliar_certificaciones_2
auxiliar_certificaciones_2 |>
mutate(ultimo_registro_cargo = as.Date(registro_cargo)) |>
arrange(desc(ultimo_registro_cargo)) |>
distinct(dni, .keep_all = TRUE) |>
select(dni, ultimo_registro_cargo) |>
mutate(ultimo_registro_cargo = as.character(ultimo_registro_cargo))->ultimos_registros_certificaciones
auxiliar_certificaciones_2 |>
distinct(dni, .keep_all = TRUE) |>
left_join(ultimos_registros_certificaciones,by="dni") |>
rename(primer_registro_cargo = registro_cargo) |>
mutate(ultimo_registro_cargo = case_when(
!is.na(baja)~ baja,
TRUE ~ ultimo_registro_cargo
)) |>
mutate(ingreso_cargo = NA) |>
rename(baja_cargo = baja) |>
mutate(baja_cargo=as.Date(baja_cargo,),
ingreso_cargo=as.Date(ingreso_cargo),
ultimo_registro_cargo = as.Date(ultimo_registro_cargo),
primer_registro_cargo=as.Date(ingreso_cargo))->interim_certificaciones_servicios_min_defensa_sept_dic_2024
external_empleados_locacion_min_seguridad_2021 |>
mutate(`Fecha Finalización`=na_if(`Fecha Finalización`,"-")) |>
mutate(`Fecha Finalización` = convert_excel_date(`Fecha Finalización`)) |>
mutate(`Fecha Finalización` = as.POSIXct(`Fecha Finalización`))->external_empleados_locacion_min_seguridad_2021
external_empleados_locacion_min_seguridad_2020 |>
mutate(`Fecha Finalización` = ammend_date(`Fecha Finalización`)) |>
mutate(`Fecha Finalización` = as.POSIXct(`Fecha Finalización`, format = "%Y-%m-%d"))->external_empleados_locacion_min_seguridad_2020
bind_rows(external_empleados_locacion_min_seguridad_2024, external_empleados_locacion_min_seguridad_2023, external_empleados_locacion_min_seguridad_2022,
external_empleados_locacion_min_seguridad_2021, external_empleados_locacion_min_seguridad_2020) |>
select(-`N° contrato`, -`Detalle de servicios prestados`,-`Nombre del funcionario firmante`,-`Forma de pago`,-`Servicios prestados`,-`Detalle de servicios prestados (cronograma de trabajo)`) |>
rename(cuit = `Cuit Contratista`) |>
mutate(dni = str_remove_all(cuit,"^..|.$")) |>
mutate(dni =str_remove_all(dni,"^0")) |>
select(-cuit) |>
rename(ingreso_cargo =`Fecha de inicio`,baja_cargo = `Fecha Finalización`,
contratista = `Nombre el contratista`, cargo = `Objeto del Contrato`, estructura = `Dependencia / área de prestación de servicios`) |>
relocate(dni) |>
mutate(nombre = str_remove_all(contratista,".+,")) |>
mutate(apellido = str_remove_all(contratista,",.+")) |>
mutate(nombre_completo = paste(nombre, apellido)) |>
select(-contratista) |>
mutate(ingreso_cargo = as.Date(ingreso_cargo), baja_cargo= as.Date(baja_cargo)) |>
arrange(desc(baja_cargo))->auxiliar_empleados_min_seguridad_2020_2024
auxiliar_empleados_min_seguridad_2020_2024 |>
arrange(ingreso_cargo) |>
distinct(dni,  .keep_all = TRUE) |>
select(dni, ingreso_cargo)->auxiliar_ingresos
auxiliar_empleados_min_seguridad_2020_2024 |>
distinct(dni, .keep_all = TRUE) |>
select(-ingreso_cargo) |>
left_join(auxiliar_ingresos) |>
rename(ultimo_registro_cargo = baja_cargo) |>
mutate(baja_cargo = NA) |>
mutate(primer_registro_cargo = ingreso_cargo) |>
mutate(organismo = "MINISTERIO DE SEGURIDAD", tipo_contratacion = "LOCACION",fuente = "PDI", poder="EJECUTIVO") |>
select(dni, nombre_completo, apellido, nombre, cargo, tipo_contratacion,organismo, estructura, ingreso_cargo, baja_cargo, primer_registro_cargo, ultimo_registro_cargo, poder, fuente) |>
mutate_if(is.character, str_to_upper) |>
mutate_if(is.character,remove_accents)->interim_empleados_locacion_seguridad_2020_2024
bind_rows(external_empleados_locacion_min_interior_2024, external_empleados_locacion_min_interior_2023, external_empleados_locacion_min_interior_2022,
external_empleados_locacion_min_interior_2021, external_empleados_locacion_min_interior_2020, external_empleados_locacion_min_interior_2019) |>
select(-`Nro. de SAF`,-`CUIT Organismo`,-`Descr. de Escalafón`, -`Nro. de Programa`,-CUIL, -`Sist. de Acceso/ Mod. de Vinc.`,-`Sist. de Acceso/Mod. de Vinc.`) |>
rename(organismo = Organismo, dni =DNI, apellido = Apellidos, nombre = Nombres,cargo = `Nivel/Categoría`,secretaria = Secretaría, subsecreataria = Subsecretaría , direccion = `Dirección Nacional/General`,jurisdiccion =Jurisdicción, jerarquia = Grado) |>
mutate(organismo = case_when(
is.na(organismo)~ jurisdiccion,
TRUE ~ organismo
)) |>
select(-jurisdiccion) |>
mutate(nombre_completo = paste(nombre, apellido)) |>
mutate(categoria_cargo = str_extract(cargo,"II|I") ) |>
mutate(categoria_cargo = case_when(
is.na(categoria_cargo)~ jerarquia,
TRUE ~ categoria_cargo
)) |>
select(-jerarquia) |>
mutate(cargo = str_squish(str_remove_all(cargo,"II$|I$")) ) |>
rename(estructura = secretaria) |>
mutate(estructura = na_if(estructura,"-")) |>
mutate(estructura = case_when(
is.na(estructura)~ subsecreataria,
TRUE ~ estructura
)) |>
select(-subsecreataria,-direccion) |>
mutate(registro_cargo = as.Date(paste0(ejercicio,"-12-31")))->auxiliar_empleados_locacion_interior
auxiliar_empleados_locacion_interior |>
arrange(registro_cargo) |>
distinct(dni, .keep_all = TRUE) |>
mutate(primer_registro_cargo = as.Date(paste0(ejercicio,"-01-31"))) |>
select(dni, primer_registro_cargo)->ingresos_min_interior
auxiliar_empleados_locacion_interior |>
arrange(desc(registro_cargo)) |>
distinct(dni, .keep_all = TRUE) |>
rename(ultimo_registro_cargo = registro_cargo) |>
select(-ejercicio) |>
left_join(ingresos_min_interior) |>
mutate(tipo_contratacion = "LOCACION") |>
mutate(poder = "EJECUTIVO") |>
mutate(fuente = "PDI") |>
mutate(ingreso_cargo = NA, baja_cargo = NA) |>
mutate_if(is_character,str_to_upper) |>
relocate(dni, nombre_completo,apellido, nombre,cargo, categoria_cargo, tipo_contratacion,organismo, estructura, ingreso_cargo, baja_cargo, primer_registro_cargo, ultimo_registro_cargo, poder, fuente) |>
mutate_if(is.character,remove_accents)->interim_empleados_locacion_min_interior_2019_2024
external_certificaciones_servicios_vice_jefatura_min_interior_sep_dec_2024 |>
rename(ultimo_registro_cargo = `Fecha de Emisión`, nombre_completo = `Nombre y Apellido del Agente`, dni = `DNI y/o CUIL`,
cargo = `Cargo desempeñado`, tipo_contratacion = `Modalida de contratación`, ingreso_cargo = `Fecha de ingreso`,
estructura = `Unidad, Dependecia o área de desempeño`) |>
select(-`Número de Certificación`,- ejercicio) |>
arrange(desc(ultimo_registro_cargo)) |>
distinct(dni,.keep_all = TRUE) |>
mutate(nombre = str_remove_all(nombre_completo,".+,"), apellido =  str_remove_all(nombre_completo,",.+"),
baja_cargo = NA) |>
mutate(tipo_contratacion = case_when(
str_detect(tipo_contratacion,"SINEP|Permanente")~"PLANTA PERMANENTE",
str_detect(tipo_contratacion,"TRANSITORIA|Autoridad Superior|Transitoria")~"PLANTA TRANSITORIA",
TRUE ~ NA
)) |>
mutate(organismo = "JEFATURA DE GABINETE - VICEJEFATURA DEL INTERIOR", primer_registro_cargo = ingreso_cargo, poder = "EJECUTIVO", fuente = "PDI") |>
relocate(dni, nombre_completo,apellido, nombre,cargo, tipo_contratacion,organismo, estructura, ingreso_cargo, baja_cargo, primer_registro_cargo, ultimo_registro_cargo, poder, fuente) |>
mutate_if(is.character, str_to_upper) |>
mutate_if(is.character,remove_accents) |>
mutate(dni = as.character(dni))->interim_certificaciones_servicios_vice_jefatura_min_interior_sep_dec_2024
bind_rows(interim_certificaciones_servicios_vice_jefatura_min_interior_sep_dec_2024,interim_empleados_locacion_min_interior_2019_2024 ) |>
distinct(dni, .keep_all = TRUE)->interim_empleados_ministerio_interior
external_certificaciones_servicios_sec_deporte_min_interior_sep_dec_2024 |>
rename(ultimo_registro_cargo = `FECHA DE EMISIÓN`, cuit = CUIL, nombre_completo = `NOMBRE Y APELLIDO`,
cargo = `CARGO DESEMPEÑADO`, estructura = DEPENDENCIA, ingreso_cargo = `FECHA INGRESO`, baja_cargo  = OBSERVACIONES, tipo_contratacion = `MODALIDAD DE CONTRTACIÓN`) |>
select(-`NÚMERO DE CERTIFICACIÓN`) |>
mutate(dni = str_remove_all(cuit,"^..|.$")) |>
mutate(dni = str_remove_all(dni,"^0")) |>
select(-cuit) |>
mutate(nombre = str_remove_all(nombre_completo,".+,"), apellido =  str_remove_all(nombre_completo,",.+"),
baja_cargo = dmy(str_remove_all(baja_cargo,"[a-zA-Z]"))) |>
mutate(tipo_contratacion = case_when(
str_detect(tipo_contratacion,"SINEP")~"PLANTA PERMANENTE",
str_detect(tipo_contratacion,"TRANSITORIA")~"PLANTA TRANSITORIA",
TRUE ~ "LOCACION"
)) |>
mutate(ultimo_registro_cargo = case_when(
!is.na(baja_cargo)~ baja_cargo,
TRUE ~ ultimo_registro_cargo
)) |>
mutate(organismo = "JEFATURA DE GABINETE - SEC DEPORTE", primer_registro_cargo = ingreso_cargo, poder = "EJECUTIVO", fuente = "PDI") |>
relocate(dni, nombre_completo,apellido, nombre,cargo, tipo_contratacion,organismo, estructura, ingreso_cargo, baja_cargo, primer_registro_cargo, ultimo_registro_cargo, poder, fuente) |>
mutate_if(is.character, str_to_upper) |>
mutate_if(is.character,remove_accents)->interim_empleados_planta_locacion_deporte_2024
external_empleados_locacion_dir_deporte_2024 |>
select(-`MONTO TOTAL DEL CONTRATO`,-`DETALLE DE LOS SERVICIOS PRESTADOS`, -`NORMBRE DEL FUNCIONARIO QUE FIRMÓ EL CONTRATO`,-`FORMA DE PAGO`,-`ADENDAS O MODIFICACIONES`, -`CUIT DEL CONTRATISTA`,-`NOMBRE DEL CONTRATISTA`) |>
rename(apellido = APELLIDO, nombre = NOMBRE, cuit = CUIL, ingreso_cargo = `FECHA DE INICIO DEL CONTRATO`,baja_cargo =  `FECHA DE FINALIZACIÓN DEL CONTRATO`, estructura = `DEPENDENCIA O ÁREA QUE SOLICITÓ EL SERVICIO`) |>
mutate(dni = str_remove_all(cuit,"^..|.$")) |>
mutate(dni = str_remove_all(dni,"^0")) |>
select(-cuit) |>
mutate(nombre_completo = paste(nombre, apellido)) |>
mutate(organismo = "JEFATURA DE GABINETE - SEC DEPORTE", tipo_contratacion = "LOCACION",fuente = "PDI", poder="EJECUTIVO")->auxiliar_empleados_locacion_dir_deporte_2024
auxiliar_empleados_locacion_dir_deporte_2024 |>
arrange(ingreso_cargo) |>
distinct(dni, .keep_all = TRUE) |>
select(dni, ingreso_cargo)->auxiliar_ingresos_deporte
auxiliar_empleados_locacion_dir_deporte_2024 |>
arrange(desc(baja_cargo)) |>
distinct(dni, .keep_all = TRUE) |>
select(-ingreso_cargo) |>
left_join(auxiliar_ingresos_deporte) |>
mutate(ingreso_cargo=as.Date(ingreso_cargo), baja_cargo = as.Date(baja_cargo)) |>
mutate(primer_registro_cargo = ingreso_cargo, ultimo_registro_cargo = baja_cargo) |>
relocate(dni, nombre_completo,apellido, nombre, tipo_contratacion,organismo, estructura, ingreso_cargo, baja_cargo, primer_registro_cargo, ultimo_registro_cargo, poder, fuente) |>
mutate_if(is.character, str_to_upper) |>
mutate_if(is.character,remove_accents)->interim_empleados_locacion_deporte_2024
bind_rows(interim_empleados_planta_locacion_deporte_2024, interim_empleados_locacion_deporte_2024) |>
distinct(dni, .keep_all = TRUE)->interim_empleados_deporte_2024
external_certificaciones_servicios_sec_ambiente_min_interior_sep_dec_2024 |>
rename(ultimo_registro_cargo = `Fecha de Emisión`, cuit = CUIL, nombre_completo = `Nombre y Apellido`,
cargo = `Cargo desempeñado`, estructura = Dependencia, ingreso_cargo = `Fecha de Ingreso`, tipo_contratacion = `Modalidad de contratación`) |>
select(-`Número de Certificación`) |>
mutate(dni = str_remove_all(cuit,"^..|.$")) |>
mutate(dni = str_remove_all(dni,"^0")) |>
select(-cuit) |>
mutate(nombre = str_remove_all(nombre_completo,".+,"), apellido =  str_remove_all(nombre_completo,",.+")) |>
mutate(tipo_contratacion = case_when(
str_detect(tipo_contratacion,"SINEP")~"PLANTA PERMANENTE",
str_detect(tipo_contratacion,"TRANSITORIA")~"PLANTA TRANSITORIA",
TRUE ~ "LOCACION"
)) |>
mutate(baja_cargo = NA, organismo = "JEFATURA DE GABINETE - SEC AMBIENTE", primer_registro_cargo = ingreso_cargo, poder = "EJECUTIVO", fuente = "PDI") |>
relocate(dni, nombre_completo,apellido, nombre, cargo,tipo_contratacion,organismo, estructura, ingreso_cargo, baja_cargo, primer_registro_cargo, ultimo_registro_cargo, poder, fuente) |>
mutate_if(is.character, str_to_upper) |>
mutate_if(is.character,remove_accents)->interim_empleados_planta_locacion_ambiente_2024
external_empleados_locacion_dir_ambiente_2024 |>
select(-`MONTO TOTAL DEL CONTRATO`,-`DETALLE DE LOS SERVICIOS PRESTADOS`, -`NORMBRE DEL FUNCIONARIO QUE FIRMÓ EL CONTRATO`,-`FORMA DE PAGO`,-`ADENDAS O MODIFICACIONES`, -`CUIT DEL CONTRATISTA`,-`NOMBRE DEL CONTRATISTA`) |>
rename(apellido = APELLIDO, nombre = NOMBRE, cuit = CUIL, ingreso_cargo = `FECHA DE INICIO DEL CONTRATO`,baja_cargo =  `FECHA DE FINALIZACIÓN DEL CONTRATO`, estructura = `DEPENDENCIA O ÁREA QUE SOLICITÓ EL SERVICIO`) |>
mutate(dni = str_remove_all(cuit,"^..|.$")) |>
mutate(dni = str_remove_all(dni,"^0|-")) |>
select(-cuit) |>
mutate(nombre_completo = paste(nombre, apellido)) |>
mutate(organismo = "JEFATURA DE GABINETE - SEC AMBIENTE", tipo_contratacion = "LOCACION",fuente = "PDI", poder="EJECUTIVO")->auxiliar_empleados_locacion_dir_ambiente_2024
auxiliar_empleados_locacion_dir_ambiente_2024 |>
arrange(ingreso_cargo) |>
distinct(dni, .keep_all = TRUE) |>
select(dni, ingreso_cargo)->auxiliar_ingresos_ambiente
auxiliar_empleados_locacion_dir_ambiente_2024 |>
arrange(desc(baja_cargo)) |>
distinct(dni, .keep_all = TRUE) |>
select(-ingreso_cargo) |>
left_join(auxiliar_ingresos_ambiente) |>
mutate(ingreso_cargo=as.Date(ingreso_cargo), baja_cargo = as.Date(baja_cargo),cargo = NA) |>
mutate(primer_registro_cargo = ingreso_cargo, ultimo_registro_cargo = baja_cargo) |>
relocate(dni, nombre_completo, apellido, nombre,  cargo,   tipo_contratacion, organismo, estructura, ingreso_cargo, baja_cargo, primer_registro_cargo, ultimo_registro_cargo) |>
mutate_if(is.character, str_to_upper)|>
mutate_if(is.character,remove_accents)->interim_empleados_locacion_ambiente_2024
bind_rows(interim_empleados_planta_locacion_ambiente_2024, interim_empleados_locacion_ambiente_2024) |>
distinct(dni, .keep_all = TRUE)->interim_empleados_ambiente_2024
external_certificaciones_servicios_sec_ambiente_turismo_deportes_min_interior_sep_dec_2024 |>
rename(ultimo_registro_cargo = `Fecha creación`,nombre_completo = Referencia, tipo_contratacion = `tipo de contratacion`,
cuit = cuil,cargo = funcion,ingreso_cargo = `fecha ingreso`) |>
select(-`Número GDE`,-`Número especial`,-`Usuario generador`, -`Tipo doc.`) |>
mutate(ultimo_registro_cargo =dmy( str_remove_all(ultimo_registro_cargo,"\\d\\d:.+")) ) |>
mutate(nombre_completo = str_remove_all(nombre_completo,"Certificado de servicios agente |Certificación de Servicios de las Abogadas|Certificación de servicios agente|SITUACION DE REVISTA|Certificado agente|Certificado laboral agente|Certificado laboral|Informe agente|	Certificación de servicios agente|CERTIFICACION DE SERVICIOS|Sr\\.|Ing\\.|Certificación de la abogada|Certificación de las abogadas|	CERTIFICACIÓN DE SERVICIOS|Certificacion de Servicios Dra\\.|Certificación de revista|SITUACIÓN DE REVISTA|CERTIFICACIÓN DE SERVICIOS")) |>
mutate(nombre_completo = str_remove_all(nombre_completo,"Licenciado|Abogado|Sra\\.|Certificación de Servicios")) |>
mutate(nombre_completo = str_remove_all(nombre_completo,"Certificacion de Servicios Agente|Certificación de servicios|certificación de servicios abogado|Srta\\.|Agente|Dra\\.|-|–")) |>
filter(!is.na(cuit)) |>
mutate(dni = str_remove_all(cuit,"^\\d\\d-|-\\d")) |>
select(-cuit) |>
mutate(tipo_contratacion = case_when(
str_detect(tipo_contratacion,"permanente")~"PLANTA PERMANENTE",
str_detect(tipo_contratacion,"transitoria|autoridad superior")~ "PLANTA TRANSITORIA",
TRUE ~ NA
)) |>
mutate(estructura = str_extract(cargo,"Direccion.+|coordinacion.+|Comisión.+|Secretaría de.+|Coordinación .+|Subsecretaría de.+|Subsecretaria de,+")) |>
mutate(cargo =str_squish( str_remove_all(cargo, estructura)) )|>
mutate(cargo = str_remove_all(cargo,"de\r\nla $|de la $ |de la$")) |>
mutate(ingreso_cargo=ammend_date_3(original_dates =  ingreso_cargo)) |>
mutate(primer_registro_cargo = ingreso_cargo) |>
mutate(organismo = "JEFATURA DE GABINETE", fuente = "PDI", poder="EJECUTIVO", nombre =NA, apellido = NA, baja_cargo = NA) |>
relocate(dni, nombre_completo, apellido, nombre,  cargo,   tipo_contratacion, organismo, estructura, ingreso_cargo, baja_cargo, primer_registro_cargo, ultimo_registro_cargo) |>
mutate_if(is.character, str_to_upper)|>
mutate_if(is.character,remove_accents) |>
arrange(desc(ultimo_registro_cargo)) |>
distinct(dni, .keep_all = TRUE) |>
mutate(ingreso_cargo=as.Date(ingreso_cargo), primer_registro_cargo = as.Date(primer_registro_cargo)) |>
mutate(primer_registro_cargo=if_else(is.na(primer_registro_cargo),as.Date("2024-09-01"), primer_registro_cargo) )->interim_certificaciones_servicios_sec_ambiente_turismo_deportes_min_interior_sep_dec_2024
external_empleados_locacion_sec_presidencia_feb_2025 |>
rename(dni = CUIL, apellido = APELLIDO, nombre =NOMBRE,estructura = SECRETARIA, baja_cargo = FECHA, ingreso_cargo = `FECHA DE INGRESO SGP`) |>
select(-`SECRETARÍA/SUBSECRETARÍA`,-BAJA) |>
mutate(dni = str_remove_all(dni,"^..")) |>
mutate(dni = str_remove_all(dni,".$")) |>
mutate(nombre_completo = paste(nombre, apellido)) |>
mutate(primer_registro_cargo = ingreso_cargo) |>
mutate(ultimo_registro_cargo = case_when(
!is.na(baja_cargo)~ as.Date(baja_cargo),
TRUE~ as.Date("2025-02-28")
)) |>
mutate(organismo = "SECRETARIA DE PRESIDENCIA", tipo_contratacion = "LOCACION",fuente = "PDI", poder="EJECUTIVO") |>
relocate(dni, nombre_completo,apellido, nombre,  tipo_contratacion,organismo, estructura, ingreso_cargo, baja_cargo, primer_registro_cargo, ultimo_registro_cargo, poder, fuente) |>
mutate_if(is.character, str_to_upper)|>
mutate_if(is.character,remove_accents) |>
distinct(dni, .keep_all = TRUE)->interim_empleados_locacion_sec_presidencia_feb_2025
#PEN
#Editamos para poder unir
colnames(external_empleados_pen_agosto_2023 )<-str_to_lower(colnames(external_empleados_pen_agosto_2023))
external_empleados_pen_agosto_2023 |>
mutate(doc = str_remove_all(cuil,"^..")) |>
mutate(doc = str_remove_all(doc,".$")) |>
mutate(doc = str_remove_all(doc,"^0")) |>
select(-cuil,-cfu_org) |>
rename(periodo = ultimo_registro)->auxiliar_2023
bind_rows(external_empleados_pen_mayo_2025,external_empleados_pen_abril_2025, external_empleados_pen_marzo_2025, external_empleados_pen_febrero_2025 ,external_empleados_pen_diciembre_2024, external_empleados_pen_noviembre_2024, external_empleados_pen_octubre_2024,
external_empleados_pen_septiembre_2024, external_empleados_pen_agosto_2024, auxiliar_2023) |>
mutate(doc = as.character(doc)) |>
distinct(doc, .keep_all = TRUE)->descartar
descartar|>
rename(ultimo_registro_cargo = periodo) |>
left_join(auxiliar_2023 |> distinct(doc, periodo), by = "doc") |>
left_join(external_empleados_pen_agosto_2024 |> distinct(doc, periodo), by = "doc") |>
left_join(external_empleados_pen_septiembre_2024 |> distinct(doc, periodo), by = "doc") |>
left_join(external_empleados_pen_octubre_2024 |> distinct(doc, periodo), by = "doc") |>
left_join(external_empleados_pen_noviembre_2024|> distinct(doc, periodo), by = "doc")  |>
left_join(external_empleados_pen_diciembre_2024|> distinct(doc, periodo), by = "doc")  |>
left_join(external_empleados_pen_febrero_2025|> distinct(doc, periodo), by = "doc")  |>
left_join(external_empleados_pen_marzo_2025|> distinct(doc, periodo), by = "doc")  |>
left_join(external_empleados_pen_abril_2025|> distinct(doc, periodo), by = "doc")  |>
distinct(doc, .keep_all = TRUE) |>
mutate(primer_registro_cargo = case_when(
!is.na(periodo.x)~ periodo.x,
!is.na(periodo.y)~ periodo.y,
!is.na(periodo.x.x)~ periodo.x.x,
!is.na(periodo.y.y)~ periodo.y.y,
!is.na(periodo.x.x.x)~ periodo.x.x.x,
!is.na(periodo.y.y.y)~ periodo.y.y.y,
!is.na(periodo.x.x.x.x)~ periodo.x.x.x.x,
!is.na(periodo.y.y.y.y)~ periodo.y.y.y.y,
!is.na(periodo)~periodo,
TRUE ~ 202505
)) |>
select(-periodo.x, -periodo.y,-periodo.x.x,-periodo.y.y,-periodo.x.x.x,-periodo.y.y.y,-periodo.x.x.x.x,-periodo.y.y.y.y, -periodo) |>
mutate(apellido_y_nombre = str_remove_all(apellido_y_nombre, "(?<=\\s)DE(?=\\s)|(?<=\\s).(?=\\s)|\\(.+\\)")) |>
mutate(nombre_completo = case_when(
str_detect(apellido_y_nombre, ".+\\s.+\\s.+\\s.+$") ~ str_replace_all(apellido_y_nombre, "(.+)\\s(.+)\\s(.+)\\s(.+)$", "\\3 \\4 \\1 \\2"),
str_detect(apellido_y_nombre, ".+\\s.+\\s.+$") ~ str_replace_all(apellido_y_nombre, "(.+)\\s(.+)\\s(.+)$", "\\2 \\3 \\1"),
str_detect(apellido_y_nombre, ".+\\s.+$") ~ str_replace_all(apellido_y_nombre, "(.+)\\s(.+)$", "\\2 \\1"),
TRUE ~ apellido_y_nombre
)) |>
select(-apellido_y_nombre,-telefono) |>
rename(dni = doc, categoria_cargo = escalafon) |>
relocate(nombre_completo, .after = dni) |>
mutate(tipo_contratacion = case_when(
str_detect(tipo_contratacion,"SERVICIO|CONTRATADO")~ "LOCACION",
str_detect(tipo_contratacion,"PERMANENTE Y TRANSITORIA") ~ "PERMANENTE O TRANSITORIA",
TRUE~ tipo_contratacion
)) |>
mutate(fecha_de_nacimiento = NA, apellido = NA, nombre = NA, cargo = NA, legajo = NA, ingreso_cargo = NA, baja_cargo = NA, estructura = NA) |>
mutate(poder = "EJECUTIVO", fuente = "BIEP") |>
relocate(dni, nombre_completo, apellido, nombre, fecha_de_nacimiento, cargo, legajo, categoria_cargo, tipo_contratacion, organismo, estructura, ingreso_cargo, baja_cargo, primer_registro_cargo, ultimo_registro_cargo) |>
mutate(primer_registro_cargo = paste0(primer_registro_cargo,"-01")) |>
mutate(primer_registro_cargo = str_replace_all(primer_registro_cargo,"^(....)","\\1-")) |>
mutate(ultimo_registro_cargo = paste0(ultimo_registro_cargo, "-28")) |>
mutate(ultimo_registro_cargo = str_replace_all(ultimo_registro_cargo, "^(....)", "\\1-")) |>
mutate(primer_registro_cargo = as.Date(primer_registro_cargo),
ultimo_registro_cargo = as.Date(ultimo_registro_cargo))|>
filter(!str_detect(categoria_cargo,"JUDICIAL")) |>
mutate_if(is.character,str_to_upper)|>
mutate_if(is.character,remove_accents)->interim_empleados_apn_2023_2025
bind_rows( interim_empleados_apn_2023_2025,interim_empleados_locacion_defensa_2019_2023,interim_certificaciones_servicios_min_defensa_sept_dic_2024,
interim_empleados_ambiente_2024, interim_empleados_deporte_2024, interim_empleados_locacion_seguridad_2020_2024, interim_empleados_ministerio_interior, interim_empleados_locacion_min_capital_humano_2024, interim_empleados_locacion_min_exteriores_2022_2024, interim_certificaciones_servicios_min_exteriores_sept_dic_2024,interim_empleados_locacion_min_salud_2019_2024,interim_empleados_locacion_jefatura_2019_2024,interim_empleados_locacion_sec_presidencia_feb_2025,interim_empleados_min_justicia_2024,interim_certificaciones_servicios_sec_ambiente_turismo_deportes_min_interior_sep_dec_2024,interim_empleados_certificaciones_jefatura_2024) |>
#OJO NO QUITAMOS DNIS REPETIDOOS PORQUE PUEDE TRATARSE DE PERSONAS DIFERENTES
#distinct(dni, .keep_all=TRUE) |>
mutate_if(is.character,str_squish)|>
arrange(desc(ultimo_registro_cargo))->processed_empleados_ejecutivo
write.csv(processed_empleados_ejecutivo,"../../../data/processed/employees/processed_empleados_ejecutivo.csv")
drive_update(as_id("1y0jXMd3jAnDetdp1fr-jXBOIeuhgSFUK"),"../../../data/processed/employees/processed_empleados_ejecutivo.csv")
file.remove("../../../data/processed/employees/processed_empleados_ejecutivo.csv")
